# 智能配置系统说明

## 🧠 条件依赖配置

本系统支持基于其他题目答案的智能选择，可以实现复杂的逻辑依赖关系。

## 📋 配置结构

### 基本格式
```json
{
  "general": {
    "conditionalRules": [
      {
        "description": "规则描述",
        "condition": {
          "questionId": "条件问题ID",
          "selectedOptions": ["选项1", "选项2"]
        },
        "effect": {
          "targetQuestionId": "目标问题ID",
          "targetOption": "单个目标选项",
          "targetOptions": ["多个目标选项1", "多个目标选项2"],
          "weightMultiplier": 权重倍数
        }
      }
    ]
  }
}
```

### 字段说明

#### condition（条件）
- `questionId`: 作为条件的问题ID
- `selectedOptions`: 触发条件的选项数组

#### effect（效果）
- `targetQuestionId`: 受影响的问题ID
- `targetOption`: 单个目标选项（与targetOptions二选一）
- `targetOptions`: 多个目标选项数组（与targetOption二选一）
- `weightMultiplier`: 权重倍数，数值越大选中概率越高

## 🎓 学历与军工历史理解程度配置示例

### 实现逻辑
- **博士研究生**：对军工历史了解程度最高（4-5分）
- **硕士研究生**：对军工历史了解程度较高（3-4分）
- **本科生**：对军工历史了解程度一般（2-3分）
- **了解程度越深**：越倾向于选择校史馆作为传承载体

### 配置示例
```json
{
  "conditionalRules": [
    {
      "description": "博士研究生对军工历史了解程度最高(4-5分)",
      "condition": {
        "questionId": "1",
        "selectedOptions": ["1"]
      },
      "effect": {
        "targetQuestionId": "4",
        "targetOptions": ["4", "5"],
        "weightMultiplier": 8
      }
    },
    {
      "description": "硕士研究生对军工历史了解程度较高(3-4分)",
      "condition": {
        "questionId": "1",
        "selectedOptions": ["2"]
      },
      "effect": {
        "targetQuestionId": "4",
        "targetOptions": ["3", "4"],
        "weightMultiplier": 5
      }
    },
    {
      "description": "本科生对军工历史了解程度一般(2-3分)",
      "condition": {
        "questionId": "1",
        "selectedOptions": ["3"]
      },
      "effect": {
        "targetQuestionId": "4",
        "targetOptions": ["2", "3"],
        "weightMultiplier": 3
      }
    },
    {
      "description": "了解程度很高(5分)的人最倾向于校史馆传承",
      "condition": {
        "questionId": "4",
        "selectedOptions": ["5"]
      },
      "effect": {
        "targetQuestionId": "6",
        "targetOption": "1",
        "weightMultiplier": 10
      }
    }
  ]
}
```

## 🔗 多层级依赖链

系统支持多层级的依赖链，例如：
```
身份(博士) → 军工历史了解程度(高) → 传承载体偏好(校史馆) → 核心价值认同(爱国奉献)
```

### 配置示例
```json
{
  "conditionalRules": [
    // 第一层：身份 → 了解程度
    {
      "description": "博士对军工历史了解深入",
      "condition": {
        "questionId": "1",
        "selectedOptions": ["1"]
      },
      "effect": {
        "targetQuestionId": "4",
        "targetOptions": ["4", "5"],
        "weightMultiplier": 8
      }
    },
    // 第二层：了解程度 → 传承载体
    {
      "description": "了解深入的人偏爱校史馆",
      "condition": {
        "questionId": "4",
        "selectedOptions": ["4", "5"]
      },
      "effect": {
        "targetQuestionId": "6",
        "targetOption": "1",
        "weightMultiplier": 6
      }
    },
    // 第三层：传承载体 → 价值认同
    {
      "description": "重视校史馆的人更认同传统价值",
      "condition": {
        "questionId": "6",
        "selectedOptions": ["1"]
      },
      "effect": {
        "targetQuestionId": "5",
        "targetOption": "1",
        "weightMultiplier": 4
      }
    }
  ]
}
```

## 🎯 权重倍数指导

| 倍数 | 效果 | 适用场景 |
|------|------|----------|
| 1-2 | 轻微影响 | 微调选择概率 |
| 3-5 | 中等影响 | 明显提高选择概率 |
| 6-8 | 强影响 | 大幅提高选择概率 |
| 9-15 | 极强影响 | 几乎必选 |

## 💡 使用技巧

### 1. 渐进式配置
从简单的单层依赖开始，逐步添加复杂的多层依赖。

### 2. 权重平衡
避免权重过高导致选择过于单一，保持适当的随机性。

### 3. 逻辑验证
配置完成后使用 `DRY_RUN=1` 模式验证规则是否按预期工作。

### 4. 描述清晰
为每个规则写清晰的描述，便于维护和调试。

## 🐛 调试模式

使用调试模式查看规则应用情况：
```bash
# Windows PowerShell
$env:DRY_RUN='1'; node .\autoSubmit.js

# Linux/Mac
DRY_RUN=1 node ./autoSubmit.js
```

调试模式会显示：
- 每个问题的权重调整情况
- 应用了哪些条件规则
- 最终的选择结果

## 📊 实际效果

通过智能配置系统，可以实现：
- **真实性更高**：符合不同群体的实际认知水平
- **逻辑连贯**：答案之间有合理的逻辑关系
- **数据质量**：生成更有价值的调研数据
- **灵活配置**：可根据需要调整各种依赖关系

---

更多配置示例和技巧，请参考项目文档或提交 Issue 讨论。
